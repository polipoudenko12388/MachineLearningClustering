# MachineLearningClustering

применение библиотеки Scikit-Learn для решения задач кластеризации с использованием метода OPTICS

Описание:

Для машинного обучения на Python написано очень много библиотек. В данной программе используется библиотека Scikit-Learn, которая упрощает процесс решения задач кластеризации и помогает более чётко выделить концепции машинного обучения.
Кластеризация в машинном обучении - группировка объектов на основе близости их свойств; каждый кластер состоит из схожих объектов, а объекты разных кластеров существенно отличаются.
Кластеризацию используют, когда отсутствуют априорные сведения относительно классов, к которым можно отнести объекты исследуемого набора
данных, либо, когда число объектов велико, что затрудняет их ручной анализ. Кластеризация отличается от классификации тем, что для проведения анализа не требуется иметь выделенную целевую переменную. Эта задача решается на начальных этапах исследования, когда о данных мало что известно. Ее решение помогает лучше понять данные, и с этой точки зрения задача кластеризации является описательной задачей (descriptive). Большое достоинство кластерного анализа в том, что он позволяет производить разбиение объектов не по одному параметру, а по целому набору признаков.  
Число методов разбиения множества на кластеры довольно велико, однако в данной задаче мы используем метод OPTICS, который  расшифровывается как Ordering points для определения структуры кластеризации. Это алгоритм неконтролируемого обучения на основе плотности, разработанный той же исследовательской группой, что и DBSCAN. У DBSCAN есть главный недостаток, заключающийся в том, что он изо всех сил пытается идентифицировать кластеры в данных различной плотности. Однако OPTICS не требует, чтобы плотность была одинаковой во всем наборе данных.
Подобно DBSCAN, алгоритм OPTICS требует два параметра — параметр ? описывает максимальное расстояние (радиус), принимаемое во внимание, а параметр MinPts описывает число точек, требующихся для образования кластера. Точка p является основной точкой, если по меньшей мере MinPts точек находятся в её ?-окрестности. 
В отличие от DBSCAN, алгоритм OPTICS рассматривает также точки, которые являются частью более плотного кластера, так что каждой точке назначается основное расстояние, которое описывает расстояние до MinPts-ой ближайшей точки.
Для большей нагладности используются графики график достижимости (особый вид древовидной схемы). Это двумерный график, на котором точки по оси x откладываются в порядке их обработки алгоритмом OPTICS, а по оси y откладывается достижимое расстояние. Поскольку точки, принадлежащие кластеру, имеют небольшое достижимое расстояние до ближайшего соседа, кластеры выглядят как долины на графике достижимости. Чем глубже долина, тем плотнее кластер. Или строятся диаграммы, на которых показывается как разделяются объекты на кластеры в зависимости от признаков, которые были использованы (используются 2 признака из используемых данных).

В данной программе мы реализуем кластеризацию для разделения исследуемых данных на кластеры для последующего их анализа. 

Применение:

Вначале при выборе данных необходимо иметь ввиду, чтобы они относились к решению задач классификации или кластеризации,  не были помечены, не было текстовых данных или пропущенных, так как данная программа не обрабатывает вышеописанные ситуации. 
Также данные должны быть формата '.csv' и разделены на тренировочные и тестовые.
В качестве исследуемых данных используется "Набор данных BuddyMove". Этот набор данных был составлен на основе отзывов о направлениях, опубликованных 249 рецензентами на сайте holidayiq.com до октября 2014 года. Были рассмотрены отзывы, попадающие в 6 категорий среди направлений по всей Южной Индии, и зафиксировано количество отзывов в каждой категории для каждого рецензента (путешественника).

dataTraining = pd.read_csv('dataTraining.csv', nrows=кол-во строк)
dataTest =  pd.read_csv('dataTesting.csv', header=None, skiprows = с какой строки начать считывание)

Создаем модель:
optics_model = OPTICS() 
и обучаем ее на тренировочных данных с помощью метода fit.
Для для вывода сгруппированных объектов по кластерам используем labels = optics_model.labels_[optics_model.ordering_], где 
optics_model.labels_ - выводит метки кластеров объектов, которые сопоставляются с id объектами, которые им принадлежат;
optics_model.ordering_ - для вывода id сгруппированных объектов по кластерам;

Далее с помощью самостоятельно реализуемого метода createDiagrams выводим график достижимости и диаграмму, чтобы посмотреть, как разделяются объекты на кластеры в зависимости от признаков, которые были использованы.

После с помощью метода fit_predict производим предсказание на тестовых данных. И в конце производим эксперименты подбора гиперпараметров для последующего анализа выводимых результатов с целью выявления лучшего подбора для кластеризации данных. 

Настройка проекта:

Проект написан на python.
Для его запуска необходимо установить вначале Anaconda – дистрибутив языков программирования Python и R, включающий набор популярных свободных библиотек, объединённых проблематиками науки о данных и машинного обучения.
После необходимо использовать терминал для запуска jupyter notebook. Его лучше запускать из папки, в которой будет находиться ваш проект. Перейти в соответствующую папку можно с помощью команды cd. После чего пишем в командной строке jupyter notebook.
Если все шаги выполнены верно, то в браузере откроется jupyter notebook, вы увидите список файлов из вашей рабочей папки (если она не
пуста) и сможете создать новый notebook.

